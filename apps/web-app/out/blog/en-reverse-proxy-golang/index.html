<!DOCTYPE html><html lang="en-US"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><title data-next-head="">Reverse Proxy with Go | Jerens Lensun</title><meta name="robots" content="follow, index" data-next-head=""/><meta name="description" content="A reverse proxy is the application that sits in front of back-end applications and forwards client (e.g. browser) requests to those applications." data-next-head=""/><meta property="og:title" content="Reverse Proxy with Go | Jerens Lensun" data-next-head=""/><meta property="og:url" content="https://www.jerenslensun.com/Reverse Proxy with Go" data-next-head=""/><meta property="og:description" content="A reverse proxy is the application that sits in front of back-end applications and forwards client (e.g. browser) requests to those applications." data-next-head=""/><meta property="og:site_name" content="Jerens" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta name="image" property="og:image" content="https://res.cloudinary.com/do9os7lxv/image/upload/v1655199836/personal/networking.jpg" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@jerensl22" data-next-head=""/><meta name="twitter:title" content="Reverse Proxy with Go" data-next-head=""/><meta name="twitter:description" content="A reverse proxy is the application that sits in front of back-end applications and forwards client (e.g. browser) requests to those applications." data-next-head=""/><meta name="twitter:image" content="https://res.cloudinary.com/do9os7lxv/image/upload/v1655199836/personal/networking.jpg" data-next-head=""/><meta name="application-name" content="Jerens"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="default"/><meta name="apple-mobile-web-app-title" content="Jerens"/><meta name="description" content="Personal portfolio and blog presented by Jerens Lensun. I&#x27;m writing about tech specializing in software development."/><meta name="format-detection" content="telephone=no"/><meta name="mobile-web-app-capable" content="yes"/><link rel="shortcut icon" href="/favicon.ico"/><link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png"/><meta name="theme-color" content="#FFFFFF"/><link rel="preload" href="/_next/static/media/1f3fe8c6df3d47c1-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/3a8dc5763a8ae4b2-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/010cad3b7953a18e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/010cad3b7953a18e.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-dc600c1e75f304ad.js" defer=""></script><script src="/_next/static/chunks/framework-1f5cdb1ea8fdada7.js" defer=""></script><script src="/_next/static/chunks/main-20badec9a2372234.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e9d9f6f007fa3648.js" defer=""></script><script src="/_next/static/chunks/cd97a040-7d441082cfe5dcf8.js" defer=""></script><script src="/_next/static/chunks/800-657a79b159a53e13.js" defer=""></script><script src="/_next/static/chunks/797-29bcc5fa6bf97e45.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-68d52018e138bdbf.js" defer=""></script><script src="/_next/static/Dlv4_LQMCiEBECrYovDWf/_buildManifest.js" defer=""></script><script src="/_next/static/Dlv4_LQMCiEBECrYovDWf/_ssgManifest.js" defer=""></script></head><body><div id="__next"><script>((e,r,s,u,d,m,l,h)=>{let c=document.documentElement,v=["light","dark"];function p(i){(Array.isArray(e)?e:[e]).forEach(y=>{let k=y==="class",S=k&&m?d.map(f=>m[f]||f):d;k?(c.classList.remove(...S),c.classList.add(i)):c.setAttribute(y,i)}),R(i)}function R(i){h&&v.includes(i)&&(c.style.colorScheme=i)}function a(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(u)p(u);else try{let i=localStorage.getItem(r)||s,y=l&&i==="system"?a():i;p(y)}catch(i){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="Toastify"></div><main class="__variable_c59aa5 __variable_197c49 font-mono"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PKW49NT"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><nav class="fixed w-full z-10 bg-background px-5vw"><div class="flex text-center justify-between h-full w-full border-gray-100"><a class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 font-sans font-medium text-xl my-5 py-2" href="/">Jerens</a><div class="flex text-center my-auto gap-2"><div class="text-center relative h-full hidden md:flex"><a class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 font-sans hidden md:block font-medium text-gray-800 dark:text-white text-xl my-4 mx-5 py-2" href="/blog/">Blog</a><a class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 font-sans hidden md:block font-medium text-gray-800 dark:text-white text-xl my-4 mx-5 py-2" href="/project/">Project</a><a class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 font-sans hidden md:block font-medium text-gray-800 dark:text-white text-xl my-4 mx-5 py-2" href="/about/">About</a></div><button type="button" aria-label="Notification permission" class="m-auto rounded-full text-sm font-medium w-10 h-10 disabled:text-on-surface/12 disabled:bg-on-surface-variant/12 hover:brightness-108 active:brightness-110 border border-outline text-on-surface-variant"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 m-auto"><path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0M10.5 8.25h3l-3 4.5h3"></path></svg></button></div></div></nav><div class="fixed flex w-full px-10 py-2 bottom-0 h-18 bg-white dark:bg-neutral-800 z-40 md:hidden"><div class="flex justify-between w-full"><div class="flex-1 group"><a class="no-underline flex items-end justify-center text-center mx-auto px-4 pt-2 w-full text-gray-600 dark:text-gray-200 group-hover:text-red-500 border-b-2 border-transparent group-hover:border-red-500" href="/"><span class="block px-1 pt-1 pb-2"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="house" class="svg-inline--fa fa-house block" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M575.8 255.5c0 18-15 32.1-32 32.1l-32 0 .7 160.2c0 2.7-.2 5.4-.5 8.1l0 16.2c0 22.1-17.9 40-40 40l-16 0c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1L416 512l-24 0c-22.1 0-40-17.9-40-40l0-24 0-64c0-17.7-14.3-32-32-32l-64 0c-17.7 0-32 14.3-32 32l0 64 0 24c0 22.1-17.9 40-40 40l-24 0-31.9 0c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2l-16 0c-22.1 0-40-17.9-40-40l0-112c0-.9 0-1.9 .1-2.8l0-69.7-32 0c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"></path></svg><span class="text-xs pb-1 block">Home</span></span></a></div><div class="flex-1 group"><a class="no-underline flex items-end justify-center text-center mx-auto px-4 pt-2 w-full text-gray-600 dark:text-gray-200 group-hover:text-red-500 border-b-2 border-transparent group-hover:border-red-500" href="/blog/"><span class="block px-1 pt-1 pb-2"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy block" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z"></path></svg><span class="text-xs pb-1 block">Blog</span></span></a></div><div class="flex-1 group"><a class="no-underline flex items-end justify-center text-center mx-auto px-4 pt-2 w-full text-gray-600 dark:text-gray-200 group-hover:text-red-500 border-b-2 border-transparent group-hover:border-red-500" href="/project/"><span class="block px-1 pt-1 pb-2"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-code" class="svg-inline--fa fa-file-code block" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M64 0C28.7 0 0 28.7 0 64L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-288-128 0c-17.7 0-32-14.3-32-32L224 0 64 0zM256 0l0 128 128 0L256 0zM153 289l-31 31 31 31c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0L71 337c-9.4-9.4-9.4-24.6 0-33.9l48-48c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9zM265 255l48 48c9.4 9.4 9.4 24.6 0 33.9l-48 48c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l31-31-31-31c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0z"></path></svg><span class="text-xs pb-1 block">Project</span></span></a></div><div class="flex-1 group"><a class="no-underline flex items-end justify-center text-center mx-auto px-4 pt-2 w-full text-gray-600 dark:text-gray-200 group-hover:text-red-500 border-b-2 border-transparent group-hover:border-red-500" href="/about/"><span class="block px-1 pt-1 pb-2"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="address-card" class="svg-inline--fa fa-address-card block" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l448 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32zm80 256l64 0c44.2 0 80 35.8 80 80c0 8.8-7.2 16-16 16L80 384c-8.8 0-16-7.2-16-16c0-44.2 35.8-80 80-80zm-32-96a64 64 0 1 1 128 0 64 64 0 1 1 -128 0zm256-32l128 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-128 0c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64l128 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-128 0c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64l128 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-128 0c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><span class="text-xs pb-1 block">About</span></span></a></div></div></div><main><header class="pt-20 text-center"><h1 class="m-auto p-4 text-3xl font-bold max-w-4xl">Reverse Proxy with Go</h1><p class="text-xl pt-1 pb-2 font-medium">June 14, 2022</p><img alt="Person" loading="lazy" width="700" height="350" decoding="async" data-nimg="1" class="object-cover m-auto" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 700 350&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;&#x27;/%3E%3C/svg%3E&quot;)" srcSet="https://ik.imagekit.io/jerensl/tr:di-project-default.webp,w-750,q-75/networking.jpg 1x, https://ik.imagekit.io/jerensl/tr:di-project-default.webp,w-1920,q-75/networking.jpg 2x" src="https://ik.imagekit.io/jerensl/tr:di-project-default.webp,w-1920,q-75/networking.jpg"/></header><main class="py-10 flex flex-col max-w-7xl sm:flex-row-reverse m-auto"><aside class="py-10 w-[350px]"><div class="sm:sticky top-36 sm:flex"><div class="max-h-[calc(100vh-9rem-113px)] overflow-auto pb-4 px-12"><h3 class="text-gray-900 text-center sm:text-left dark:text-gray-100 md:text-xl font-bold">Table of Contents</h3><ul class="mt-4 flex flex-col sm:space-y-1 text-sm"></ul></div></div></aside><article id="mdx" class="prose mx-4 sm:mx-0 sm:ml-20 flex-1 max-w-4xl m-auto dark:prose-invert prose-p:font-normal prose-li:font-normal lg:prose-lg"><p>The reverse proxy will bring anonymity to the server behind it and make the server more secure
because users don&#x27;t know where they will interact within, another benefit is caching and load balancing.
On the other hand, golang provides an easy way to build a reverse proxy using a standard library.</p>
<h2 id="uses-cases" class="text-lg scroll-mt-20">Uses cases</h2>
<ul>
<li><strong>Load Balancing</strong>,
A reverse proxy can be used to load balance requests from users, the interesting part is we can have a minimum of one server.</li>
<li><strong>Gateway</strong>,
Reversed proxy can be used as a gateway to multiple Restful API services, not just that there are several open-source projects that map restful API reverse proxy to GRPC server such as grpc-gateway.</li>
<li><strong>SSl Termination</strong>,
SSL Termination, can be used to encrypt incoming and outgoing requests to and from reversed proxy only and let the server behind reverse proxy unencrypted.</li>
<li><strong>Caching</strong>,
A reverse proxy can temporarily save the response data coming from the internal server.</li>
</ul>
<h2 id="implementation" class="text-lg scroll-mt-20">Implementation</h2>
<p>To get started, we need to build HTTP router using http package.</p>
<ul>
<li>Create a server we need to import it from <code>net/http</code> library.</li>
<li>After that we call ListenAndServe, who took 2 argument<!-- -->
<ul>
<li>The first one is the address, and then we put port in the argument</li>
<li>The second one is <code>DefaultServeMux</code> but in this case, we want to use the default one provided by the HTTP package,
so we just put nill</li>
</ul>
</li>
<li>If the server is not running, we just make it panic</li>
</ul>
<div class="relative code-block"><pre class="c-bJjmLR c-bJjmLR-BvZaj-showlinenumbers-true c-bJjmLR-iptiid-theme-orange c-bJjmLR-idlLbEU-css"><code class="language-go" showlinenumbers="" theme="orange"><div data-line="1" class="highlight-line" data-highlighted="false"><span class="token keyword">package</span> main
</div><div data-line="2" class="highlight-line" data-highlighted="false">
</div><div data-line="3" class="highlight-line" data-highlighted="false"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</div><div data-line="4" class="highlight-line" data-highlighted="false">	<span class="token string">&quot;net/http&quot;</span>
</div><div data-line="5" class="highlight-line" data-highlighted="false">	<span class="token string">&quot;fmt&quot;</span>
</div><div data-line="6" class="highlight-line" data-highlighted="false"><span class="token punctuation">)</span>
</div><div data-line="7" class="highlight-line" data-highlighted="false">
</div><div data-line="8" class="highlight-line" data-highlighted="false"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</div><div data-line="9" class="highlight-line" data-highlighted="false">	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> reverseProxyHandler<span class="token punctuation">)</span>
</div><div data-line="10" class="highlight-line" data-highlighted="false">
</div><div data-line="11" class="highlight-line" data-highlighted="false">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Starting users service at port: %v&quot;</span><span class="token punctuation">,</span> <span class="token number">8000</span><span class="token punctuation">)</span>
</div><div data-line="12" class="highlight-line" data-highlighted="false">	<span class="token keyword">if</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:5000&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</div><div data-line="13" class="highlight-line" data-highlighted="false">		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
</div><div data-line="14" class="highlight-line" data-highlighted="false">	<span class="token punctuation">}</span>
</div><div data-line="15" class="highlight-line" data-highlighted="false"><span class="token punctuation">}</span>
</div></code></pre><button aria-label="Copy code" type="button" class="absolute right-3 top-3 w-8 h-8 p-1 rounded border-2 bg-slate-700 dark:bg-gray-800 hover:border-gray-300 hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" fill="none" class="text-gray-300"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></button></div>
<p>The next step we will implement reverseProxyHandler function, which is the implementation of <code>http.HandleFunc</code>.
The first argument is a writer to a response and the second argument is a pointer to a request from user.</p>
<ul>
<li>Inside the function, we will use <code>url.Parse</code> to parse the URL string, which will separate such as host, path, etc
to the struct URL and return it, if the URL string argument is invalid,
it will give an error and we just respond with an bad gateway error using <code>w.writeHeader</code> and return it directly
to the client.</li>
<li>After that, we can send the result URL parse, to the <code>NewSingleHostReverseProxy</code> who comes from httputil package.
It will prepare either requests or headers from clients to reverse proxy servers.</li>
<li>Finally, we come to the final part, so we need to check it the reverse proxy is not empty, then do the request
to the internal server using <code>ServerHTTP</code>, and passed forward the request, then get back the response to the client.</li>
</ul>
<div class="relative code-block"><pre class="c-bJjmLR c-bJjmLR-BvZaj-showlinenumbers-true c-bJjmLR-iptiid-theme-orange c-bJjmLR-idlLbEU-css"><code class="language-go" showlinenumbers="" theme="orange"><div data-line="1" class="highlight-line" data-highlighted="false"><span class="token keyword">func</span> <span class="token function">reverseProxyHandler</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</div><div data-line="2" class="highlight-line" data-highlighted="false">	host<span class="token punctuation">,</span> err <span class="token operator">:=</span> url<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:5001&quot;</span><span class="token punctuation">)</span>
</div><div data-line="3" class="highlight-line" data-highlighted="false">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</div><div data-line="4" class="highlight-line" data-highlighted="false">		w<span class="token punctuation">.</span><span class="token function">WriteHeader</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusBadGateway<span class="token punctuation">)</span>
</div><div data-line="5" class="highlight-line" data-highlighted="false">		<span class="token keyword">return</span>
</div><div data-line="6" class="highlight-line" data-highlighted="false">	<span class="token punctuation">}</span>
</div><div data-line="7" class="highlight-line" data-highlighted="false">
</div><div data-line="8" class="highlight-line" data-highlighted="false">	reverseProxy <span class="token operator">:=</span> httputil<span class="token punctuation">.</span><span class="token function">NewSingleHostReverseProxy</span><span class="token punctuation">(</span>host<span class="token punctuation">)</span>
</div><div data-line="9" class="highlight-line" data-highlighted="false">	<span class="token keyword">if</span> reverseProxy <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</div><div data-line="10" class="highlight-line" data-highlighted="false">		reverseProxy<span class="token punctuation">.</span><span class="token function">ServeHTTP</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
</div><div data-line="11" class="highlight-line" data-highlighted="false">	<span class="token punctuation">}</span>
</div><div data-line="12" class="highlight-line" data-highlighted="false">	http<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token string">&quot;Service not available&quot;</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusServiceUnavailable<span class="token punctuation">)</span>
</div><div data-line="13" class="highlight-line" data-highlighted="false"><span class="token punctuation">}</span>
</div></code></pre><button aria-label="Copy code" type="button" class="absolute right-3 top-3 w-8 h-8 p-1 rounded border-2 bg-slate-700 dark:bg-gray-800 hover:border-gray-300 hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" fill="none" class="text-gray-300"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></button></div>
<h2 id="final-result" class="text-lg scroll-mt-20">Final Result</h2>
<div class="relative code-block"><pre class="c-bJjmLR c-bJjmLR-BvZaj-showlinenumbers-true c-bJjmLR-iptiid-theme-orange c-bJjmLR-idlLbEU-css"><code class="language-go" showlinenumbers="" theme="orange"><div data-line="1" class="highlight-line" data-highlighted="false"><span class="token keyword">package</span> main
</div><div data-line="2" class="highlight-line" data-highlighted="false">
</div><div data-line="3" class="highlight-line" data-highlighted="false"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</div><div data-line="4" class="highlight-line" data-highlighted="false">	<span class="token string">&quot;fmt&quot;</span>
</div><div data-line="5" class="highlight-line" data-highlighted="false">	<span class="token string">&quot;net/url&quot;</span>
</div><div data-line="6" class="highlight-line" data-highlighted="false">	<span class="token string">&quot;net/http&quot;</span>
</div><div data-line="7" class="highlight-line" data-highlighted="false">	<span class="token string">&quot;net/http/httputil&quot;</span>
</div><div data-line="8" class="highlight-line" data-highlighted="false"><span class="token punctuation">)</span>
</div><div data-line="9" class="highlight-line" data-highlighted="false">
</div><div data-line="10" class="highlight-line" data-highlighted="false"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</div><div data-line="11" class="highlight-line" data-highlighted="false">	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> reverseProxyHandler<span class="token punctuation">)</span>
</div><div data-line="12" class="highlight-line" data-highlighted="false">
</div><div data-line="13" class="highlight-line" data-highlighted="false">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Starting users service at port: %v&quot;</span><span class="token punctuation">,</span> <span class="token number">8000</span><span class="token punctuation">)</span>
</div><div data-line="14" class="highlight-line" data-highlighted="false">	<span class="token keyword">if</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:5000&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</div><div data-line="15" class="highlight-line" data-highlighted="false">		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
</div><div data-line="16" class="highlight-line" data-highlighted="false">	<span class="token punctuation">}</span>
</div><div data-line="17" class="highlight-line" data-highlighted="false">
</div><div data-line="18" class="highlight-line" data-highlighted="false">	<span class="token keyword">func</span> <span class="token function">reverseProxyHandler</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</div><div data-line="19" class="highlight-line" data-highlighted="false">	host<span class="token punctuation">,</span> err <span class="token operator">:=</span> url<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:5001&quot;</span><span class="token punctuation">)</span>
</div><div data-line="20" class="highlight-line" data-highlighted="false">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</div><div data-line="21" class="highlight-line" data-highlighted="false">		w<span class="token punctuation">.</span><span class="token function">WriteHeader</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusBadGateway<span class="token punctuation">)</span>
</div><div data-line="22" class="highlight-line" data-highlighted="false">		<span class="token keyword">return</span>
</div><div data-line="23" class="highlight-line" data-highlighted="false">	<span class="token punctuation">}</span>
</div><div data-line="24" class="highlight-line" data-highlighted="false">
</div><div data-line="25" class="highlight-line" data-highlighted="false">	reverseProxy <span class="token operator">:=</span> httputil<span class="token punctuation">.</span><span class="token function">NewSingleHostReverseProxy</span><span class="token punctuation">(</span>host<span class="token punctuation">)</span>
</div><div data-line="26" class="highlight-line" data-highlighted="false">	<span class="token keyword">if</span> reverseProxy <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</div><div data-line="27" class="highlight-line" data-highlighted="false">		reverseProxy<span class="token punctuation">.</span><span class="token function">ServeHTTP</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
</div><div data-line="28" class="highlight-line" data-highlighted="false">	<span class="token punctuation">}</span>
</div><div data-line="29" class="highlight-line" data-highlighted="false">	http<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token string">&quot;Service not available&quot;</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusServiceUnavailable<span class="token punctuation">)</span>
</div><div data-line="30" class="highlight-line" data-highlighted="false"><span class="token punctuation">}</span>
</div></code></pre><button aria-label="Copy code" type="button" class="absolute right-3 top-3 w-8 h-8 p-1 rounded border-2 bg-slate-700 dark:bg-gray-800 hover:border-gray-300 hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" fill="none" class="text-gray-300"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></button></div>
<h2 id="summary" class="text-lg scroll-mt-20">Summary</h2>
<p>In the end, it&#x27;s good to know and learn how easy to implement it on golang, so for a production environment,
I recommended using some of the popular proxies such as HAProxy, Nginx, Traefik, etc.
In terms of performance comparison, there are people already doing the benchmark so I will refer to the that <a target="_blank" rel="noopener noreferrer" class="italic no-underline" href="https://github.com/juliens/Proxy-Benchmarks">repository</a></p>
<h2 id="aditional" class="text-lg scroll-mt-20">Aditional</h2>
<ul>
<li><a target="_blank" rel="noopener noreferrer" class="italic no-underline" href="https://www.youtube.com/watch?v=tWSmUsYLiE4">FOSDEM 2019: How to write a reverse proxy with Go in 25 minutes.</a></li>
</ul></article></main><div class="h-20 lg:h-32"></div><div class="relative px-5vw mt-10"><footer class="relative mx-auto grid max-w-7xl grid-cols-4 grid-rows-max-content gap-x-4 md:grid-cols-8 xl:grid-cols-12 xl:gap-x-6"><div class="col-span-full md:col-span-4 xl:col-span-6"><div><h1 class="text-xl font-medium text-center sm:text-left">Jerens S. Lensun</h1><p class="text-center sm:text-left mb-4 md:mb-6 max-w-md text-2xl">Software Engineering</p><div class="flex space-x-6 h-10 justify-center sm:justify-start py-1"><a target="_blank" rel="noopener noreferrer" aria-label="Github" class="italic no-underline" href="https://twitter.com/jerensl22"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="square-twitter" class="svg-inline--fa fa-square-twitter fa-2x hover:text-red-600 cursor-pointer" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM351.3 199.3v0c0 86.7-66 186.6-186.6 186.6c-37.2 0-71.7-10.8-100.7-29.4c5.3 .6 10.4 .8 15.8 .8c30.7 0 58.9-10.4 81.4-28c-28.8-.6-53-19.5-61.3-45.5c10.1 1.5 19.2 1.5 29.6-1.2c-30-6.1-52.5-32.5-52.5-64.4v-.8c8.7 4.9 18.9 7.9 29.6 8.3c-9-6-16.4-14.1-21.5-23.6s-7.8-20.2-7.7-31c0-12.2 3.2-23.4 8.9-33.1c32.3 39.8 80.8 65.8 135.2 68.6c-9.3-44.5 24-80.6 64-80.6c18.9 0 35.9 7.9 47.9 20.7c14.8-2.8 29-8.3 41.6-15.8c-4.9 15.2-15.2 28-28.8 36.1c13.2-1.4 26-5.1 37.8-10.2c-8.9 13.1-20.1 24.7-32.9 34c.2 2.8 .2 5.7 .2 8.5z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="Github" class="italic no-underline" href="http://instagram.com/jerensl"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="instagram" class="svg-inline--fa fa-instagram fa-2x hover:text-red-600 cursor-pointer" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="Github" class="italic no-underline" href="https://www.linkedin.com/in/jerensl/"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin fa-2x hover:text-red-600 cursor-pointer" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="Github" class="italic no-underline" href="https://github.com/jerensl"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="square-github" class="svg-inline--fa fa-square-github fa-2x hover:text-red-600 cursor-pointer" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M448 96c0-35.3-28.7-64-64-64H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96zM265.8 407.7c0-1.8 0-6 .1-11.6c.1-11.4 .1-28.8 .1-43.7c0-15.6-5.2-25.5-11.3-30.7c37-4.1 76-9.2 76-73.1c0-18.2-6.5-27.3-17.1-39c1.7-4.3 7.4-22-1.7-45c-13.9-4.3-45.7 17.9-45.7 17.9c-13.2-3.7-27.5-5.6-41.6-5.6s-28.4 1.9-41.6 5.6c0 0-31.8-22.2-45.7-17.9c-9.1 22.9-3.5 40.6-1.7 45c-10.6 11.7-15.6 20.8-15.6 39c0 63.6 37.3 69 74.3 73.1c-4.8 4.3-9.1 11.7-10.6 22.3c-9.5 4.3-33.8 11.7-48.3-13.9c-9.1-15.8-25.5-17.1-25.5-17.1c-16.2-.2-1.1 10.2-1.1 10.2c10.8 5 18.4 24.2 18.4 24.2c9.7 29.7 56.1 19.7 56.1 19.7c0 9 .1 21.7 .1 30.6c0 4.8 .1 8.6 .1 10c0 4.3-3 9.5-11.5 8C106 393.6 59.8 330.8 59.8 257.4c0-91.8 70.2-161.5 162-161.5s166.2 69.7 166.2 161.5c.1 73.4-44.7 136.3-110.7 158.3c-8.4 1.5-11.5-3.7-11.5-8zm-90.5-54.8c-.2-1.5 1.1-2.8 3-3.2c1.9-.2 3.7 .6 3.9 1.9c.3 1.3-1 2.6-3 3c-1.9 .4-3.7-.4-3.9-1.7zm-9.1 3.2c-2.2 .2-3.7-.9-3.7-2.4c0-1.3 1.5-2.4 3.5-2.4c1.9-.2 3.7 .9 3.7 2.4c0 1.3-1.5 2.4-3.5 2.4zm-14.3-2.2c-1.9-.4-3.2-1.9-2.8-3.2s2.4-1.9 4.1-1.5c2 .6 3.3 2.1 2.8 3.4c-.4 1.3-2.4 1.9-4.1 1.3zm-12.5-7.3c-1.5-1.3-1.9-3.2-.9-4.1c.9-1.1 2.8-.9 4.3 .6c1.3 1.3 1.8 3.3 .9 4.1c-.9 1.1-2.8 .9-4.3-.6zm-8.5-10c-1.1-1.5-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3c1.1 1.5 1.1 3.3 0 4.1c-.9 .6-2.6 0-3.7-1.5zm-6.3-8.8c-1.1-1.3-1.3-2.8-.4-3.5c.9-.9 2.4-.4 3.5 .6c1.1 1.3 1.3 2.8 .4 3.5c-.9 .9-2.4 .4-3.5-.6zm-6-6.4c-1.3-.6-1.9-1.7-1.5-2.6c.4-.6 1.5-.9 2.8-.4c1.3 .7 1.9 1.8 1.5 2.6c-.4 .9-1.7 1.1-2.8 .4z"></path></svg></a></div></div></div><div class="col-span-full md:col-span-2 mt-10 md:mt-0 xl:col-span-3"><div><h2 class="text-xl font-medium text-gray-500 dark:text-white">Contact</h2><div class="mt-2 flex font-normal flex-col gap-1"><a target="_blank" rel="noopener noreferrer" class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 text-lg not-italic mr-auto" href="https://twitter.com/jerensl22">Twitter</a><a target="_blank" rel="noopener noreferrer" class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 text-lg not-italic mr-auto" href="http://instagram.com/jerensl"> Instagram</a><a target="_blank" rel="noopener noreferrer" class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 text-lg not-italic mr-auto" href="https://www.linkedin.com/in/jerensl/">Linkedin</a><a target="_blank" rel="noopener noreferrer" class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 text-lg not-italic mr-auto" href="https://github.com/jerensl">Github</a><a target="_blank" rel="noopener noreferrer" class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 text-lg not-italic mr-auto" href="https://github.com/jerensl">RSS</a></div></div></div><div class="col-span-full md:col-span-2 mt-10 md:mt-0 xl:col-span-1"><div><h2 class="text-xl font-medium text-gray-500 dark:text-white">Sitemap</h2><div class="mt-2 flex font-normal flex-col gap-1"><a class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 text-lg mr-auto" href="/">Home</a><a class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 text-lg mr-auto" href="/blog/">Blog</a><a class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 text-lg mr-auto" href="/project/">Project</a><a class="no-underline relative after:content-[&#x27;&#x27;] after:absolute after:h-[3px] after:w-full after:bg-on-surface after:left-0 after:bottom-[-0.2rem] after:scale-x-0 after:scale-y-100 hover:after:scale-x-100 after:transition after:duration-20 text-lg mr-auto" href="/about/">About</a></div></div></div><div class="col-span-full my-5 text-lg mb-24 md:mb-10 dark:text-blueGray-500 md:my-5 border-t border-gray-500"><span>Â© <!-- -->2025<!-- --> Jerens Lensun. All Rights Reserved.</span></div></footer></div></main></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":{"code":"var Component=(()=\u003e{var p=Object.create;var s=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var k=(a,e)=\u003e()=\u003e(e||a((e={exports:{}}).exports,e),e.exports),f=(a,e)=\u003e{for(var t in e)s(a,t,{get:e[t],enumerable:!0})},h=(a,e,t,l)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let i of m(e))!N.call(a,i)\u0026\u0026i!==t\u0026\u0026s(a,i,{get:()=\u003ee[i],enumerable:!(l=u(e,i))||l.enumerable});return a};var v=(a,e,t)=\u003e(t=a!=null?p(g(a)):{},h(e||!a||!a.__esModule?s(t,\"default\",{value:a,enumerable:!0}):t,a)),w=a=\u003eh(s({},\"__esModule\",{value:!0}),a);var r=k((P,c)=\u003e{c.exports=_jsx_runtime});var b={};f(b,{default:()=\u003eo,frontmatter:()=\u003ey});var n=v(r()),y={title:\"Reverse Proxy with Go\",date:\"2022-06-14\",cover:\"networking.jpg\",isPublished:!0,description:\"A reverse proxy is the application that sits in front of back-end applications and forwards client (e.g. browser) requests to those applications.\",tags:[\"golang\",\"gateway\"]};function d(a){let e={a:\"a\",code:\"code\",div:\"div\",h2:\"h2\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...a.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:`The reverse proxy will bring anonymity to the server behind it and make the server more secure\nbecause users don't know where they will interact within, another benefit is caching and load balancing.\nOn the other hand, golang provides an easy way to build a reverse proxy using a standard library.`}),`\n`,(0,n.jsx)(e.h2,{id:\"uses-cases\",children:\"Uses cases\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Load Balancing\"}),`,\nA reverse proxy can be used to load balance requests from users, the interesting part is we can have a minimum of one server.`]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Gateway\"}),`,\nReversed proxy can be used as a gateway to multiple Restful API services, not just that there are several open-source projects that map restful API reverse proxy to GRPC server such as grpc-gateway.`]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"SSl Termination\"}),`,\nSSL Termination, can be used to encrypt incoming and outgoing requests to and from reversed proxy only and let the server behind reverse proxy unencrypted.`]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Caching\"}),`,\nA reverse proxy can temporarily save the response data coming from the internal server.`]}),`\n`]}),`\n`,(0,n.jsx)(e.h2,{id:\"implementation\",children:\"Implementation\"}),`\n`,(0,n.jsx)(e.p,{children:\"To get started, we need to build HTTP router using http package.\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Create a server we need to import it from \",(0,n.jsx)(e.code,{children:\"net/http\"}),\" library.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"After that we call ListenAndServe, who took 2 argument\",`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"The first one is the address, and then we put port in the argument\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"The second one is \",(0,n.jsx)(e.code,{children:\"DefaultServeMux\"}),` but in this case, we want to use the default one provided by the HTTP package,\nso we just put nill`]}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(e.li,{children:\"If the server is not running, we just make it panic\"}),`\n`]}),`\n`,(0,n.jsx)(e.pre,{showlinenumbers:\"\",theme:\"orange\",children:(0,n.jsxs)(e.code,{className:\"language-go\",showlinenumbers:\"\",theme:\"orange\",children:[(0,n.jsxs)(e.div,{\"data-line\":\"1\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"package\"}),` main\n`]}),(0,n.jsx)(e.div,{\"data-line\":\"2\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:`\n`}),(0,n.jsxs)(e.div,{\"data-line\":\"3\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"4\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"net/http\"'}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"5\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"fmt\"'}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"6\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.div,{\"data-line\":\"7\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:`\n`}),(0,n.jsxs)(e.div,{\"data-line\":\"8\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"9\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\thttp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"HandleFunc\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"/\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" reverseProxyHandler\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.div,{\"data-line\":\"10\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:`\n`}),(0,n.jsxs)(e.div,{\"data-line\":\"11\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"    fmt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Printf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Starting users service at port: %v\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"12\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" http\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ListenAndServe\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\":5000\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"13\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"panic\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"14\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"15\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"The next step we will implement reverseProxyHandler function, which is the implementation of \",(0,n.jsx)(e.code,{children:\"http.HandleFunc\"}),`.\nThe first argument is a writer to a response and the second argument is a pointer to a request from user.`]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Inside the function, we will use \",(0,n.jsx)(e.code,{children:\"url.Parse\"}),` to parse the URL string, which will separate such as host, path, etc\nto the struct URL and return it, if the URL string argument is invalid,\nit will give an error and we just respond with an bad gateway error using `,(0,n.jsx)(e.code,{children:\"w.writeHeader\"}),` and return it directly\nto the client.`]}),`\n`,(0,n.jsxs)(e.li,{children:[\"After that, we can send the result URL parse, to the \",(0,n.jsx)(e.code,{children:\"NewSingleHostReverseProxy\"}),` who comes from httputil package.\nIt will prepare either requests or headers from clients to reverse proxy servers.`]}),`\n`,(0,n.jsxs)(e.li,{children:[`Finally, we come to the final part, so we need to check it the reverse proxy is not empty, then do the request\nto the internal server using `,(0,n.jsx)(e.code,{children:\"ServerHTTP\"}),\", and passed forward the request, then get back the response to the client.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.pre,{showlinenumbers:\"\",theme:\"orange\",children:(0,n.jsxs)(e.code,{className:\"language-go\",showlinenumbers:\"\",theme:\"orange\",children:[(0,n.jsxs)(e.div,{\"data-line\":\"1\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"reverseProxyHandler\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"w http\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ResponseWriter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" r \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"http\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Request\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"2\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\thost\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Parse\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"http://localhost:5001\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"3\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"4\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\tw\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"WriteHeader\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"http\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"StatusBadGateway\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"5\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"6\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.div,{\"data-line\":\"7\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:`\n`}),(0,n.jsxs)(e.div,{\"data-line\":\"8\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\treverseProxy \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" httputil\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewSingleHostReverseProxy\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"host\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"9\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" reverseProxy \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"10\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\treverseProxy\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ServeHTTP\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"w\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"11\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"12\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\thttp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Error\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"w\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Service not available\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" http\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"StatusServiceUnavailable\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"13\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.h2,{id:\"final-result\",children:\"Final Result\"}),`\n`,(0,n.jsx)(e.pre,{showlinenumbers:\"\",theme:\"orange\",children:(0,n.jsxs)(e.code,{className:\"language-go\",showlinenumbers:\"\",theme:\"orange\",children:[(0,n.jsxs)(e.div,{\"data-line\":\"1\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"package\"}),` main\n`]}),(0,n.jsx)(e.div,{\"data-line\":\"2\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:`\n`}),(0,n.jsxs)(e.div,{\"data-line\":\"3\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"4\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"fmt\"'}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"5\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"net/url\"'}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"6\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"net/http\"'}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"7\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"net/http/httputil\"'}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"8\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.div,{\"data-line\":\"9\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:`\n`}),(0,n.jsxs)(e.div,{\"data-line\":\"10\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"11\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\thttp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"HandleFunc\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"/\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" reverseProxyHandler\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.div,{\"data-line\":\"12\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:`\n`}),(0,n.jsxs)(e.div,{\"data-line\":\"13\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"    fmt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Printf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Starting users service at port: %v\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"14\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" http\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ListenAndServe\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\":5000\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"15\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"panic\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"16\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.div,{\"data-line\":\"17\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:`\n`}),(0,n.jsxs)(e.div,{\"data-line\":\"18\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"reverseProxyHandler\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"w http\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ResponseWriter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" r \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"http\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Request\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"19\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\thost\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Parse\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"http://localhost:5001\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"20\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"21\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\tw\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"WriteHeader\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"http\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"StatusBadGateway\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"22\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"23\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.div,{\"data-line\":\"24\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:`\n`}),(0,n.jsxs)(e.div,{\"data-line\":\"25\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\treverseProxy \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" httputil\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewSingleHostReverseProxy\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"host\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"26\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" reverseProxy \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"27\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\treverseProxy\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ServeHTTP\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"w\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"28\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"29\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[\"\thttp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Error\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"w\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Service not available\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" http\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"StatusServiceUnavailable\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.div,{\"data-line\":\"30\",className:\"highlight-line\",\"data-highlighted\":\"false\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.h2,{id:\"summary\",children:\"Summary\"}),`\n`,(0,n.jsxs)(e.p,{children:[`In the end, it's good to know and learn how easy to implement it on golang, so for a production environment,\nI recommended using some of the popular proxies such as HAProxy, Nginx, Traefik, etc.\nIn terms of performance comparison, there are people already doing the benchmark so I will refer to the that `,(0,n.jsx)(e.a,{href:\"https://github.com/juliens/Proxy-Benchmarks\",children:\"repository\"})]}),`\n`,(0,n.jsx)(e.h2,{id:\"aditional\",children:\"Aditional\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://www.youtube.com/watch?v=tWSmUsYLiE4\",children:\"FOSDEM 2019: How to write a reverse proxy with Go in 25 minutes.\"})}),`\n`]})]})}function o(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,{...a,children:(0,n.jsx)(d,{...a})}):d(a)}return w(b);})();\n;return Component;","frontmatter":{"title":"Reverse Proxy with Go","date":"2022-06-14","cover":"networking.jpg","isPublished":true,"description":"A reverse proxy is the application that sits in front of back-end applications and forwards client (e.g. browser) requests to those applications.","tags":["golang","gateway"]},"metadata":{"slug":"en-reverse-proxy-golang","fileName":"en-reverse-proxy-golang.mdx","blurDataURL":null}},"blurDataURL":null,"currentYear":2025},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"en-reverse-proxy-golang"},"buildId":"Dlv4_LQMCiEBECrYovDWf","isFallback":false,"gsp":true,"scriptLoader":[{"id":"katex","strategy":"lazyOnload","dangerouslySetInnerHTML":{"__html":"\u003c/style\u003e\n                        \u003clink\n                        rel=\"stylesheet\"\n                        href=\"https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css\"\n                        integrity=\"sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn\"\n                        crossOrigin=\"anonymous\"\n                        media=\"print\"\n                        onload=\"this.media='all'; this.onload=null;\"\n                        /\u003e\n                        \u003cstyle\u003e"}}]}</script></body></html>